<html>

<head>
  <meta charset="UTF-8">
  <link rel="stylesheet" type="text/css"
    href="https://cdnjs.cloudflare.com/ajax/libs/milligram/1.2.3/milligram.min.css">
  <link rel="stylesheet" type="text/css" href="styles.css">
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"
    integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js"></script>
</head>

<body class="container">
  <p><a href="index.html">Back to Landing Page</a></p>
  <h2>Account dApp</h2>

  <!-- Import Notifications -->
  <div id="notifications"></div>

  <hr>

  <!-- Webpage Frontend-->
  <table>
    <thead>
      <tr>
        <th>Address</th>
        <th>Balance</th>
      </tr>
    </thead>
    <tbody id="accounts">
      <tr>
        <td colspan="2">Trying to load your accounts...</td>
      </tr>
    </tbody>
  </table>

  <hr>

  <b class="repo">Repository File:</b><br><a
    href="https://github.com/lukso-network/example-dapps-ethjs/blob/master/accounts.html"
    target="_blank">lukso-network/example-dapps-ethjs/accounts.html</a>

  <script type="text/javascript" src="ethereumjs-testrpc.js"></script>
  <script type="text/javascript" src="ethjs.js"></script>

  <!-- Connect Extension & Check Network & Check Balance & Change Network-->
  <script src="./utils.js"></script>

  <!-- Query Selector & Login Event Function & Network Swap Function-->
  <script src="./events.js"></script>

  <!-- Main Function -->
  <script type="text/javascript">
    var eth = new Eth(TestRPC.provider());
    var el = function (id) { return document.querySelector(id); };

    /*
    // uncomment to enable MetaMask support:
    if (typeof window.web3 !== 'undefined' && typeof window.web3.currentProvider !== 'undefined') {
      eth.setProvider(window.web3.currentProvider);
    } else {
      eth.setProvider(provider); // set to TestRPC if not available
    }
    */

    eth.accounts(function (accountsError, accounts) {
      if (accountsError) {
        el('#accounts').innerHTML = 'Hmm.. looks like there was an error: '
          + String(accountsError);
      }

      el('#accounts').innerHTML = '';

      accounts.forEach(function (account) {
        el('#accounts').innerHTML += '<tr><td>'
          + account + '</td><td id="accountBalance_'
          + account + '"></td></tr>';

        eth.getBalance(account, function (balanceError, balance) {
          el('#accountBalance_' + account).innerHTML += Eth.fromWei(balance, 'ether')
            + ' ether';
        });
      });
    });
  </script>
</body>

</html>